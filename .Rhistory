install.packages("devtools")
proj2::betas()
proj2::peixes
devtools::document()
proj2::banco
banco
peixes <- proj2::banco
save(banco, file = "data/peixes.rda")
save(peixes, file = "data/peixes.rda")
update.packages("proj2")
peixes
save(peixes, file = "data/peixes.rda")
devtools::document()
devtools::document()
devtools::document()
proj2::betas()
devtools::document()
proj2::peixes
matriz_delineamento(peixes)
matriz_delineamento(peixes, c("Length1", "Species"))
matriz_delineamento(peixes, c("Length1", "rato"))
matriz_delineamento <- function(dados, variaveis) {
tryCatch(formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+"))),
error = stop("Verifique se as colunas selecionadas estão no banco de dados inserido.")
)
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
matriz_delineamento(peixes, c("Length1", "rato"))
matriz_delineamento <- function(dados, variaveis) {
tryCatch(formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+"))),
error = stop("Verifique se as colunas selecionadas estão no banco de dados inserido.
Também verifique se estão escritas corretamente. Lembre-se de colocá-las entre \"aspas\".")
)
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
matriz_delineamento(peixes, c("Length1", "rato"))
matriz_delineamento <- function(dados, variaveis) {
tryCatch(formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+"))),
error = stop("Verifique se as colunas selecionadas estão no banco de dados inserido.
Também verifique se estão escritas corretamente. Lembre-se de colocá-las entre \"aspas\".")
)
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
matriz_delineamento(peixes, c("Length1", "rato"))
peixes[[Weight]]
peixes[[Weighth]]
peixes[[Weigth]]
peixes[["Weigth"]]
peixes[["Weight"]]
!is.numeric(peixes[["Weight"]])
!is.numeric(peixes[["Weighta"]])
#'@title Coeficientes da Regressão
#'@description
#'Encontra os coeficientes na regressão
#'linear múltipla,
#'\deqn{Y = \beta_{0}+\beta_{1}X_{1}+...+\beta_{p-1}X_{p-1}+\epsilon}.
#'
#'@details
#'É necessário que a matriz de delineamento tenha posto completo.
#'
#'@param dados Banco de dados para análise;
#'@param variavel_resposta Variável resposta, da qual queremos
#'fazer a predição;
#'@param variaveis_preditoras Vetor composto pelas variáveis
#'que serão usadas na predição.
#'
#'@return
#'Relação dos coeficientes e suas estimativas.
#'
#'@export
betas <- function(dados, variavel_resposta, variaveis_preditoras) {
x_ <- matriz_delineamento(dados = dados,
variaveis = variaveis_preditoras)
if (det(t(x_) %*% x_) == 0) {
stop("Matriz não tem posto completo. Retire algumas das variáveis e tente novamente.")
}
if (!is.numeric(dados[[variavel_resposta]])) {
stop("1) Variável resposta precisa ser numérica. Reveja sua entrada.
2) Verifique se a variável resposta está no banco de dados, e se está escrita corretamente (entre \"aspas\").")
}
betas_ <- solve(t(x_) %*% x_,
t(x_) %*% dados[[variavel_resposta]])
return(betas_)
}
betas(peixes, "Weight", c("Lenght1"))
betas(peixes, "Weight", c("Length1"))
data(peixes)
View(peixes)
betas(peixes, "Weight", c("Length1", "Length2"))
matriz_delineamento <- function(dados, variaveis) {
#tryCatch(
formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+")))#,
#           error = stop("Verifique se as colunas selecionadas estão no banco de dados inserido.
#Também verifique se estão escritas corretamente. Lembre-se de colocá-las entre \"aspas\".")
# )
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "Length2"))
betas(peixes, "Weight", c("Length1", "Length2"))
matriz_delineamento <- function(dados, variaveis) {
tryCatch(formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+"))),
error = stop("Verifique se as colunas selecionadas estão no banco de dados inserido.
Também verifique se estão escritas corretamente. Lembre-se de colocá-las entre \"aspas\".")
)
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "Length2"))
matriz_delineamento <- function(dados, variaveis) {
tryCatch(formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+"))),
error = function(e) {stop("Verifique se as colunas selecionadas estão no banco de dados inserido.
Também verifique se estão escritas corretamente. Lembre-se de colocá-las entre \"aspas\".")
})
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "Length2"))
betas(peixes, "Weight", c("Length1", "Length2"))
betas(peixes, "Weight", c("Length1", "a"))
matriz_delineamento <- function(dados, variaveis) {
formula_ <- tryCatch({as.formula(paste0("~",
paste(variaveis, collapse = "+")))},
error = function(e) {stop("Verifique se as colunas selecionadas estão no banco de dados inserido.
Também verifique se estão escritas corretamente. Lembre-se de colocá-las entre \"aspas\".")
})
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "a"))
betas(peixes, "Weight", c("Length1", "Length2"))
matriz_delineamento <- function(dados, variaveis) {
formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+")))
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "Length2"))
matriz_delineamento <- function(dados, variaveis) {
if (length(setdiff(colnames(dados),
variaveis)) > 0) {
stop(paste("As seguintes variáveis não estão presentes no banco de dados: ",
setdiff(colnames(dados),variaveis)))
}
formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+")))
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "a"))
betas(peixes, "Weight", c("Length1", "a", "b"))
betas(peixes, "Weight", c("Length1", "a", "b"))
betas(peixes, "Weight", c("Length1", "a", "b"))
matriz_delineamento <- function(dados, variaveis) {
if (length(setdiff(colnames(dados),
variaveis)) > 0) {
stop(paste("As seguintes variáveis não estão presentes no banco de dados: ",
paste(setdiff(colnames(dados),variaveis),
collapse = "\n")))
}
formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+")))
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "a", "b"))
setdiff(peies, c("a"))
setdiff(peixes, c("a"))
setdiff(colnames(peixes), c("a"))
setdiff(colnames(peixes), c("a", "b"))
setdiff(c("a", "b"), colnames("peixes"))
setdiff(c("Species"), colnames("peixes"))
setdiff(c("Species"), colnames(peixes))
matriz_delineamento <- function(dados, variaveis) {
if (length(setdiff(variaveis,
colnames(dados)
)
) > 0) {
stop(paste("As seguintes variáveis não estão presentes no banco de dados: ",
paste(setdiff(variaveis, colnames(dados)),
collapse = "\n")))
}
formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+")))
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "a", "b"))
matriz_delineamento <- function(dados, variaveis) {
if (length(setdiff(variaveis,
colnames(dados)
)
) > 0) {
stop(paste("As seguintes variáveis não estão presentes no banco de dados:\n",
paste(setdiff(variaveis, colnames(dados)),
collapse = "\n")))
}
formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+")))
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "a", "b"))
matriz_delineamento <- function(dados, variaveis) {
if (length(setdiff(variaveis,
colnames(dados)
)
) > 0) {
stop(paste0("As seguintes variáveis não estão presentes no banco de dados:\n",
paste(setdiff(variaveis, colnames(dados)),
collapse = "\n"),
"Verifique se estão no banco de dados e escritas corretamente."))
}
formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+")))
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "a", "b"))
betas(peixes, "Weight", c("Length1", "a", "b"))
matriz_delineamento <- function(dados, variaveis) {
if (length(setdiff(variaveis,
colnames(dados)
)
) > 0) {
stop(paste0("As seguintes variáveis não estão presentes no banco de dados:\n",
paste(setdiff(variaveis, colnames(dados)),
collapse = "\n"),
"\nVerifique se estão no banco de dados e escritas corretamente."))
}
formula_ <- as.formula(paste0("~",
paste(variaveis, collapse = "+")))
matriz_ <- model.matrix(formula_,
data = dados)
return(matriz_)
}
betas(peixes, "Weight", c("Length1", "a", "b"))
